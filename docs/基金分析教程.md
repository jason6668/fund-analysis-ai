# 基金智能分析系统使用教程

## 📚 目录

1. [系统简介](#系统简介)
2. [快速开始](#快速开始)
3. [配置说明](#配置说明)
4. [基金代码格式](#基金代码格式)
5. [运行示例](#运行示例)
6. [常见问题](#常见问题)

## 📖 系统简介

这是一个基于 AI 大模型的基金智能分析系统，可以：

- 📊 自动分析基金净值走势
- 💡 提供投资建议和操作策略
- 📱 推送分析结果到微信/飞书/Telegram
- ⏰ 每日定时自动执行
- 🎯 基于稳健投资理念，避免追高

## 🚀 快速开始

### 方式一：GitHub Actions（推荐）

**完全免费，无需服务器！**

1. **Fork 本仓库**
   - 访问：https://github.com/你的用户名/daily_stock_analysis
   - 点击右上角 `Fork` 按钮

2. **配置 Secrets**
   
   进入仓库 → `Settings` → `Secrets and variables` → `Actions` → `New repository secret`
   
   必填配置：
   ```
   GEMINI_API_KEY=你的Gemini密钥
   FUND_LIST=000001,110022,161725,040046
   ```
   
   推送渠道（至少配置一个）：
   ```
   WECHAT_WEBHOOK_URL=企业微信webhook地址
   FEISHU_WEBHOOK_URL=飞书webhook地址
   TELEGRAM_BOT_TOKEN=Telegram机器人token
   TELEGRAM_CHAT_ID=Telegram聊天ID
   ```

3. **启用 Actions**
   - 进入 `Actions` 标签
   - 点击 `I understand my workflows, go ahead and enable them`

4. **手动测试**
   - `Actions` → `每日基金分析` → `Run workflow`
   - 选择运行模式，点击 `Run workflow`

5. **完成！**
   - 系统将在每个工作日 18:00 自动运行

### 方式二：本地运行

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **配置环境变量**
   
   复制 `.env.example` 为 `.env`，然后编辑：
   ```bash
   # AI 配置
   GEMINI_API_KEY=你的Gemini密钥
   
   # 基金列表
   FUND_LIST=000001,110022,161725,040046
   
   # 推送配置（任选一个）
   WECHAT_WEBHOOK_URL=你的企业微信webhook
   ```

3. **运行程序**
   ```bash
   # 基本运行
   python main.py
   
   # 调试模式
   python main.py --debug
   
   # 分析特定基金
   python main.py --funds 000001,110022
   ```

## ⚙️ 配置说明

### 基金列表配置

在 `.env` 文件或 GitHub Secrets 中设置 `FUND_LIST`：

```bash
# 多个基金代码用逗号分隔
FUND_LIST=000001,110022,161725,040046,163406
```

### AI 模型配置

**主力：Google Gemini（免费）**

1. 访问 https://aistudio.google.com/
2. 登录并创建 API Key
3. 配置到 `GEMINI_API_KEY`

**备选：OpenAI 兼容 API**

支持 DeepSeek、通义千问等：

```bash
OPENAI_API_KEY=你的API密钥
OPENAI_BASE_URL=https://api.deepseek.com/v1
OPENAI_MODEL=deepseek-chat
```

### 推送渠道配置

可以同时配置多个，系统会全部推送：

**企业微信**
```bash
WECHAT_WEBHOOK_URL=https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx
```

**飞书**
```bash
FEISHU_WEBHOOK_URL=https://open.feishu.cn/open-apis/bot/v2/hook/xxx
```

**Telegram**
```bash
TELEGRAM_BOT_TOKEN=123456:ABC-DEF...
TELEGRAM_CHAT_ID=你的chat_id
```

**邮件**
```bash
EMAIL_SENDER=你的邮箱@qq.com
EMAIL_PASSWORD=邮箱授权码（不是登录密码）
EMAIL_RECEIVERS=接收邮箱1@qq.com,接收邮箱2@gmail.com
```

## 📋 基金代码格式

### 国内基金

**场外基金（6位数字）**
- 华夏成长：`000001`
- 易方达价值成长：`110022`
- 兴全合润：`163406`
- 华安纳斯达克100：`040046`

**场内基金（ETF，6位数字）**
- 南方中证500ETF：`510500`
- 华泰柏瑞沪深300ETF：`510300`
- 嘉实沪深300ETF：`159919`

### 示例配置

```bash
# 混合配置：场外基金 + ETF
FUND_LIST=000001,110022,163406,510500,159919
```

## 💻 运行示例

### 1. 基本运行

```bash
# 分析配置文件中的所有基金
python main.py
```

### 2. 指定基金分析

```bash
# 只分析指定的基金
python main.py --funds 000001,110022,163406
```

### 3. 调试模式

```bash
# 输出详细日志
python main.py --debug
```

### 4. 测试模式（不推送）

```bash
# 只分析不推送通知
python main.py --no-notify
```

### 5. 单基金推送模式

```bash
# 每分析完一只基金立即推送
python main.py --single-notify
```

### 6. 启动 Web 管理界面

```bash
# 启动 WebUI + 执行分析
python main.py --webui

# 仅启动 WebUI（手动触发分析）
python main.py --webui-only
```

访问 http://127.0.0.1:8000 即可使用 Web 界面。

### 7. 定时任务模式

```bash
# 每日 18:00 自动运行
python main.py --schedule
```

## ❓ 常见问题

### Q1: 如何获取 Gemini API Key？

1. 访问 https://aistudio.google.com/
2. 登录 Google 账号
3. 点击 "Get API Key" → "Create API Key"
4. 复制生成的 Key

### Q2: 基金代码在哪里查看？

- **天天基金网**：https://fund.eastmoney.com/
- **蚂蚁财富**：支付宝 → 理财 → 基金
- **同花顺基金**：https://fund.10jqka.com.cn/

基金详情页会显示基金代码（6位数字）。

### Q3: 推送不成功怎么办？

1. 检查 webhook URL 是否正确
2. 检查网络连接（GitHub Actions 无需代理）
3. 查看日志文件 `logs/` 目录
4. 使用 `--debug` 模式查看详细输出

### Q4: 支持哪些类型的基金？

系统支持所有有净值数据的基金：
- ✅ 股票型基金
- ✅ 混合型基金
- ✅ 指数型基金
- ✅ ETF 基金
- ✅ QDII 基金
- ❌ 货币基金（净值变化小，不适合分析）
- ❌ 债券基金（可分析但意义不大）

### Q5: 如何理解分析结果？

**投资建议**：
- 🟢 强烈推荐 / 适合买入：趋势向上，当前位置较好
- 🟡 继续持有 / 观望等待：等待更好的买入时机
- 🔴 考虑卖出 / 强烈卖出：趋势向下，建议规避

**关键指标**：
- **趋势状态**：基金中长期趋势方向
- **距离MA5**：当前净值与5日均线的距离，负值表示回调
- **年度收益**：近一年的收益率
- **评分**：综合评分，分数越高越推荐

### Q6: 数据更新频率？

- 基金净值：每个交易日更新一次（通常晚上）
- 系统分析：默认每日 18:00 自动运行
- 可以随时手动运行获取最新分析

### Q7: 系统稳定性如何？

- ✅ 异常处理：单个基金失败不影响其他
- ✅ 数据容错：数据源失败自动切换
- ✅ API 限流：自动延迟避免被限
- ✅ 日志记录：完整的日志便于排查

### Q8: 如何自定义分析策略？

编辑 `src/fund_analyzer.py` 文件：

```python
# 修改警戒阈值
CHASE_HIGH_THRESHOLD = 10.0  # 追高警戒线
PULLBACK_BUY_THRESHOLD = -3.0  # 回调买入区域

# 修改评分权重
# 在 _generate_signal 方法中调整评分逻辑
```

### Q9: 推送消息太多怎么办？

可以设置只推送重要信息：

1. 使用 `--no-notify` 跳过推送
2. 在配置中设置 `REPORT_TYPE=simple`
3. 调整基金列表，减少分析数量

### Q10: 能否回测历史表现？

当前版本暂不支持回测功能，这是一个计划中的功能。

你可以查看基金的历史净值数据作为参考。

## 📞 获取帮助

- **GitHub Issues**：https://github.com/ZhuLinsen/daily_stock_analysis/issues
- **项目文档**：查看 `docs/` 目录

## ⚠️ 风险提示

本系统仅供学习研究使用，不构成投资建议。基金投资有风险，决策需谨慎。

---

祝您投资顺利，稳健获利！ 💰
